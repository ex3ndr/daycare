import { databaseMigrate } from "./databaseMigrate.js";
import { databaseOpenTest } from "./databaseOpenTest.js";
import { Storage } from "./storage.js";

/**
 * Opens in-memory test storage, applies migrations, and returns Storage facade.
 * Expects: always returns a fresh in-memory storage instance.
 */
export async function storageOpenTest(): Promise<Storage> {
    const db = databaseOpenTest();
    await databaseMigrate(db);
    return Storage.fromDatabase(db);
}
